# توثيق وظيفة الترجمة التلقائية

## نظرة عامة

تم إضافة وظيفة الترجمة التلقائية للبيانات من اللغة العربية إلى اللغة الإنجليزية في النظام. هذه الوظيفة تعمل تلقائيًا عند إدخال البيانات باللغة العربية، حيث يتم ترجمتها إلى اللغة الإنجليزية وتخزينها في حقول الترجمة الإنجليزية المقابلة.

## النماذج المدعومة

تم إضافة وظيفة الترجمة التلقائية للنماذج التالية:

1. **المريض (Patient)**:
   - الاسم (name -> name_en)
   - الجنسية (nationality -> nationality_en)
   - جهة العمل (employer_name -> employer_name_en)
   - العنوان (address -> address_en)

2. **الطبيب (Doctor)**:
   - الاسم (name -> name_en)
   - المنصب (position -> position_en)

3. **المستشفى (Hospital)**:
   - الاسم (name -> name_en)
   - العنوان (address -> address_en)

4. **العميل (Client)**:
   - الاسم (name -> name_en)
   - العنوان (address -> address_en)
   - الملاحظات (notes -> notes_en)

5. **المرافق (Companion)**:
   - يتم التعامل مع المرافق كمريض في النظام، لذلك يتم ترجمة بياناته بنفس طريقة المريض.

## آلية العمل

1. **الترجمة عند الإنشاء**:
   - عند إنشاء كائن جديد (مريض، طبيب، مستشفى، عميل)، يتم التحقق من وجود بيانات باللغة العربية وعدم وجود ترجمة إنجليزية لها.
   - إذا كانت البيانات العربية موجودة والترجمة الإنجليزية غير موجودة، يتم استخدام خدمة Google Translate لترجمة البيانات تلقائيًا.

2. **الترجمة عند إنشاء الإجازات**:
   - عند إنشاء إجازة مرضية أو إجازة مرافق، يتم التحقق من وجود ترجمة إنجليزية للمريض والطبيب والمستشفى.
   - إذا كانت الترجمة الإنجليزية غير موجودة، يتم ترجمة البيانات تلقائيًا.

3. **التعامل مع الأخطاء**:
   - تم تضمين معالجة الأخطاء في عملية الترجمة، بحيث إذا فشلت الترجمة لأي سبب، يستمر النظام في العمل بدون توقف.

## التنفيذ التقني

تم تنفيذ وظيفة الترجمة التلقائية من خلال:

1. **إضافة دالة save() مخصصة للنماذج**:
   - تم تعديل دالة save() في النماذج المذكورة أعلاه لتنفيذ الترجمة التلقائية.

2. **استخدام مكتبة googletrans**:
   - تم استخدام مكتبة googletrans الإصدار 4.0.0-rc1 للترجمة.

3. **تعديل وظائف AJAX**:
   - تم تعديل وظائف AJAX لإنشاء الكائنات بحيث تستخدم دالة save() المخصصة بدلاً من objects.create().

## مثال على الكود

```python
def save(self, *args, **kwargs):
    """حفظ المريض مع ترجمة البيانات تلقائيًا"""
    # ترجمة الاسم والجنسية وجهة العمل والعنوان إلى الإنجليزية إذا كانت فارغة
    if self.name and not self.name_en:
        try:
            from googletrans import Translator
            translator = Translator()
            translation = translator.translate(self.name, src='ar', dest='en')
            self.name_en = translation.text
        except Exception:
            pass

    # ... المزيد من الترجمات ...

    super().save(*args, **kwargs)
```

## الاستخدام

لا يحتاج المستخدم إلى القيام بأي إجراء إضافي لاستخدام وظيفة الترجمة التلقائية. عند إدخال البيانات باللغة العربية، سيتم ترجمتها تلقائيًا إلى اللغة الإنجليزية وتخزينها في حقول الترجمة الإنجليزية المقابلة.

## ملاحظات

1. **الترجمة غير المثالية**:
   - قد لا تكون الترجمة التلقائية مثالية دائمًا، خاصة للمصطلحات الطبية أو الأسماء الخاصة.
   - يمكن للمستخدم تعديل الترجمة يدويًا إذا لزم الأمر.

2. **الاتصال بالإنترنت**:
   - تتطلب وظيفة الترجمة التلقائية اتصالاً بالإنترنت للوصول إلى خدمة Google Translate.
   - إذا لم يكن هناك اتصال بالإنترنت، سيتم تخطي الترجمة بدون توقف النظام.

3. **حدود الترجمة**:
   - قد تكون هناك حدود لعدد الترجمات التي يمكن إجراؤها في فترة زمنية معينة بسبب قيود خدمة Google Translate.
   - إذا تم تجاوز هذه الحدود، قد تفشل الترجمة مؤقتًا.
