# نماذج البيانات (Models)

يحتوي النظام على مجموعة من نماذج البيانات التي تمثل الكيانات المختلفة في النظام. فيما يلي شرح تفصيلي لكل نموذج:

## نموذج المستخدم (User)

نموذج المستخدم هو نموذج مخصص يرث من `AbstractBaseUser` و `PermissionsMixin` في Django. يستخدم لإدارة المستخدمين في النظام.

### الحقول

- **username**: اسم المستخدم (فريد).
- **email**: البريد الإلكتروني للمستخدم (فريد).
- **role**: دور المستخدم في النظام (مسؤول، طبيب، موظف).
- **is_active**: ما إذا كان المستخدم نشطًا أم لا.
- **is_staff**: ما إذا كان المستخدم مسؤولاً أم لا.
- **created_at**: تاريخ إنشاء المستخدم.
- **updated_at**: تاريخ آخر تحديث للمستخدم.

### الدوال

- **is_admin()**: التحقق مما إذا كان المستخدم مسؤولاً.
- **is_doctor()**: التحقق مما إذا كان المستخدم طبيبًا.

## نموذج المستشفى (Hospital)

نموذج المستشفى يمثل المستشفيات التي يعمل بها الأطباء.

### الحقول

- **name**: اسم المستشفى.
- **address**: عنوان المستشفى (اختياري).
- **contact_info**: معلومات الاتصال بالمستشفى (اختياري).
- **created_at**: تاريخ إنشاء المستشفى.
- **updated_at**: تاريخ آخر تحديث للمستشفى.

## نموذج جهة العمل (Employer)

نموذج جهة العمل يمثل جهات العمل التي ينتمي إليها المرضى.

### الحقول

- **name**: اسم جهة العمل.
- **address**: عنوان جهة العمل (اختياري).
- **contact_info**: معلومات الاتصال بجهة العمل (اختياري).
- **created_at**: تاريخ إنشاء جهة العمل.
- **updated_at**: تاريخ آخر تحديث لجهة العمل.

## نموذج الطبيب (Doctor)

نموذج الطبيب يمثل الأطباء الذين يصدرون الإجازات المرضية.

### الحقول

- **national_id**: رقم الهوية الوطنية للطبيب (فريد).
- **name**: اسم الطبيب.
- **position**: منصب الطبيب.
- **hospital**: المستشفى الذي يعمل به الطبيب (علاقة ForeignKey مع نموذج Hospital).
- **created_at**: تاريخ إنشاء الطبيب.
- **updated_at**: تاريخ آخر تحديث للطبيب.

## نموذج المريض (Patient)

نموذج المريض يمثل المرضى الذين يحصلون على الإجازات المرضية.

### الحقول

- **national_id**: رقم الهوية الوطنية للمريض (فريد).
- **name**: اسم المريض.
- **nationality**: جنسية المريض.
- **employer**: جهة العمل التي ينتمي إليها المريض (علاقة ForeignKey مع نموذج Employer، اختياري).
- **created_at**: تاريخ إنشاء المريض.
- **updated_at**: تاريخ آخر تحديث للمريض.

## نموذج العميل (Client)

نموذج العميل يمثل العملاء الذين يدفعون مقابل الإجازات.

### الحقول

- **name**: اسم العميل.
- **phone**: رقم هاتف العميل (فريد).
- **email**: البريد الإلكتروني للعميل (اختياري).
- **address**: عنوان العميل (اختياري).
- **notes**: ملاحظات حول العميل (اختياري).
- **created_at**: تاريخ إنشاء العميل.
- **updated_at**: تاريخ آخر تحديث للعميل.

### الدوال

- **get_balance()**: حساب رصيد العميل (إجمالي الفواتير - إجمالي المدفوعات).

## نموذج سعر الإجازة (LeavePrice)

نموذج سعر الإجازة يمثل أسعار الإجازات المرضية وإجازات المرافقين.

### الحقول

- **leave_type**: نوع الإجازة (إجازة مرضية، إجازة مرافق).
- **duration_days**: مدة الإجازة بالأيام.
- **price**: سعر الإجازة.
- **is_active**: ما إذا كان السعر نشطًا أم لا.
- **created_at**: تاريخ إنشاء السعر.
- **updated_at**: تاريخ آخر تحديث للسعر.

### الدوال

- **get_price(leave_type, duration_days)**: الحصول على سعر الإجازة بناءً على النوع والمدة.

## نموذج الإجازة المرضية (SickLeave)

نموذج الإجازة المرضية يمثل الإجازات المرضية للمرضى.

### الحقول

- **leave_id**: رقم الإجازة (فريد).
- **patient**: المريض الذي يحصل على الإجازة (علاقة ForeignKey مع نموذج Patient).
- **doctor**: الطبيب الذي أصدر الإجازة (علاقة ForeignKey مع نموذج Doctor).
- **start_date**: تاريخ بداية الإجازة.
- **end_date**: تاريخ نهاية الإجازة.
- **duration_days**: مدة الإجازة بالأيام.
- **admission_date**: تاريخ دخول المريض إلى المستشفى.
- **discharge_date**: تاريخ خروج المريض من المستشفى.
- **issue_date**: تاريخ إصدار الإجازة.
- **status**: حالة الإجازة (نشطة، ملغية، منتهية).
- **created_at**: تاريخ إنشاء الإجازة.
- **updated_at**: تاريخ آخر تحديث للإجازة.

### الدوال

- **save()**: حفظ الإجازة مع حساب مدة الإجازة تلقائيًا.

## نموذج إجازة المرافق (CompanionLeave)

نموذج إجازة المرافق يمثل إجازات المرافقين للمرضى.

### الحقول

- **leave_id**: رقم الإجازة (فريد).
- **patient**: المريض الذي يحتاج إلى مرافق (علاقة ForeignKey مع نموذج Patient).
- **companion**: المرافق للمريض (علاقة ForeignKey مع نموذج Patient).
- **doctor**: الطبيب الذي أصدر الإجازة (علاقة ForeignKey مع نموذج Doctor).
- **start_date**: تاريخ بداية الإجازة.
- **end_date**: تاريخ نهاية الإجازة.
- **duration_days**: مدة الإجازة بالأيام.
- **admission_date**: تاريخ دخول المريض إلى المستشفى.
- **discharge_date**: تاريخ خروج المريض من المستشفى.
- **issue_date**: تاريخ إصدار الإجازة.
- **status**: حالة الإجازة (نشطة، ملغية، منتهية).
- **created_at**: تاريخ إنشاء الإجازة.
- **updated_at**: تاريخ آخر تحديث للإجازة.

### الدوال

- **save()**: حفظ الإجازة مع حساب مدة الإجازة تلقائيًا.

## نموذج فاتورة الإجازة (LeaveInvoice)

نموذج فاتورة الإجازة يمثل فواتير الإجازات المرضية وإجازات المرافقين.

### الحقول

- **invoice_number**: رقم الفاتورة (فريد).
- **client**: العميل الذي يدفع الفاتورة (علاقة ForeignKey مع نموذج Client).
- **leave_type**: نوع الإجازة (إجازة مرضية، إجازة مرافق).
- **leave_id**: رقم الإجازة.
- **amount**: مبلغ الفاتورة.
- **status**: حالة الفاتورة (غير مدفوعة، مدفوعة جزئيًا، مدفوعة بالكامل، ملغية).
- **issue_date**: تاريخ إصدار الفاتورة.
- **due_date**: تاريخ استحقاق الفاتورة (اختياري).
- **notes**: ملاحظات حول الفاتورة (اختياري).
- **created_at**: تاريخ إنشاء الفاتورة.
- **updated_at**: تاريخ آخر تحديث للفاتورة.

### الدوال

- **get_total_paid()**: إجمالي المبلغ المدفوع للفاتورة.
- **get_remaining()**: المبلغ المتبقي للفاتورة.
- **update_status()**: تحديث حالة الفاتورة بناءً على المدفوعات.

## نموذج الدفعة (Payment)

نموذج الدفعة يمثل المدفوعات المستلمة من العملاء.

### الحقول

- **payment_number**: رقم الدفعة (فريد).
- **client**: العميل الذي يدفع (علاقة ForeignKey مع نموذج Client).
- **amount**: مبلغ الدفعة.
- **payment_method**: طريقة الدفع (نقدًا، تحويل بنكي، شيك، بطاقة ائتمان).
- **payment_date**: تاريخ الدفع.
- **reference_number**: رقم المرجع (اختياري).
- **notes**: ملاحظات حول الدفعة (اختياري).
- **created_at**: تاريخ إنشاء الدفعة.
- **updated_at**: تاريخ آخر تحديث للدفعة.

## نموذج تفاصيل الدفعة (PaymentDetail)

نموذج تفاصيل الدفعة يمثل تفاصيل توزيع الدفعة على الفواتير.

### الحقول

- **payment**: الدفعة (علاقة ForeignKey مع نموذج Payment).
- **invoice**: الفاتورة (علاقة ForeignKey مع نموذج LeaveInvoice).
- **amount**: المبلغ المخصص للفاتورة.
- **created_at**: تاريخ إنشاء التفاصيل.
